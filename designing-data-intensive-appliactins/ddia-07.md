# 第 7 章 事务

关键字：

- 基本可用
- 软状态
- 最终一致性
- 快照隔离
- 读提交
- 可串行化
- 原子写操作
- 更新丢失
- 写倾斜
- SSI Serializable Isolation for Snapshot Databases

## ACDI

- 原子性
  在事物出错时终止事物，并将部分完成的写入全部丢弃。也许可终止性比原子性更为准确。不过我们还是原子性这个惯用的术语

进程崩溃，网络中断，磁盘变满或者违反了某种完整性约束

- 一致性
  在 ACDI 中 ，一致性主要是指数据库处于应用程序所期待的 “预期状态”。

- 隔离性
  并发执行多个事物相互个例，它们不能相互交叉

- 持久性
  事物一旦提交，即使存在硬件故障或数据库崩溃，事物锁写入的任务数据都不会丢失。

> 防止更新的丢失

- 原子写操作
- 多个写加锁
- for update

## 原子写操作

```sql
update conunters set value = value +1 where id =1;
```

原子写操作 通常是使用对对象加独占锁的方式来实现。

`for update` 指令指示数据库对返回的所有结果行要加锁。


## Links

- [隔离级别、SI 和 SSI](https://www.jianshu.com/p/c348f68fecde)