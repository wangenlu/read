# 套接字选项

- fcntl
- ioctl

fcntl 函数提供了与网络编程相关的如下特性。

非阻塞式 IO。通过使用 F_SETFL 命令设置 O_NONBLOCK 文件状态标志,我们可以把一个
套接字设置为非阻塞型。(参考 16 章)

信号驱动式 I/O，通过使用 F_SETFL 命令设置 O_ASYNC 文件状态标志,我们可以把一个套
接字设置成一旦其状态发生变化,内核就产生一个 SIGIO 信号。(参考 25 章)

F_SETOWN 命令允许我们指定用于接收 SIGIO 和 SIGURG 信号的套接字属主(进程 I 或进
程组 ID)。其中 SIGIO 信号是套接字被设置为信号驱动式 IO 型后产生的(第 25 章),
SIGURG 信号是在新的带外数据到达套接字时产生的(第 24 章)。F_GETOWN 命令返回套接字的当前属主。

```txt
术语“套接宇属主”由 POSIX 定义。历史上源自 Berkeley 的实现称之为“套接字的进程组
ID”,因为存放该 ID 的变量是 socket 结构的 so_pgid 成员(TCPV2 第 438 页)
```

使用 socket 函数新创建的套接字并没有属主。然而如果一个新的套接字是从一个监听套接
字创建来的,那么套接字属主将由已连接套接字从监听套接字继承而来(许多套接字选项也是
这样继承,见 TCPV2 第 462~463 页)。
