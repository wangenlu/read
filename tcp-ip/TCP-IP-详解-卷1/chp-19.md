# TCP 的交互数据流

- 经受时延的确认
- Nagle 算法 减少了通过广域网络传输的小分组的数
- 窗口大小通告

## 经受时延的确认

通常 TCP 在接收到数据时并不立即发送 ACK；相反，它推迟发送，以便将 ACK 与需要沿该方向发送的数据一起发送（有时
称这种现象为数据捎带 ACK）。绝大多数实现采用的时延为 200ms，也就是说，TCP 将以最大 200ms 的时延等待是否有数据一起发送。

## Nagle 算法

如果连接上客户一般每次发送一个字节到服务器，被称为微小分组（tinygram）,这些小分组则会增加拥塞出现的可能。
一种简单和好的方法就是采用 RFC896[Nagle1984]中所建议的 Nagle 算法。

Nagle 算法，该算法要求一个 TCP 连接上最多只能有一个未被确认的未完成的小分组，在该分组的确
认到达之前不能发送其他的小分组。相反， TCP 收集这些少量的分组，并在确认到来时以一
个分组的方式发出去。该算法的优越之处在于它是自适应的：确认到达得越快，数据也就发
送得越快。而在希望减少微小分组数目的低速广域网上，则会发送更少的分

在较慢的广域网环境中，通常使用 Nagle 算法来减少这些小报文段的数目。这个算法限制
发送者任何时候只能有一个发送的小报文段未被确认。

插口 API 用户可以使用 `TCPNODELAY` 选项来关闭`Nagle`算法。
