# 广播和多播

- 单播地址
- 广播地址
- 多播地址
- 受限的广播 255.255.255.255
- 指向网络的广播
- 指向子网的广播
- 指向所有子网的广播
- todo

首先，网卡查看由信道传送过来的帧，确定是否接收
该帧，若接收后就将它传往设备驱动程序。通常网卡仅接
收那些目的地址为网卡物理地址或广播地址的帧。另外，
多数接口均被设置为混合模式，这种模式能接收每个帧的
一个复制。作为一个例子， `tcpdump` 使用这种模式。

目前，大多数的网卡经过配置都能接收目的地址为多
播地址或某些子网多播地址的帧。对于以太网，当地址中
最高字节的最低位设置为1时表示该地址是一个多播地址，
用十六进制可表示为 01:00:00:00:00:00（以太网广播地址
ff:ff:ff:ff:ff:ff 可看作是以太网多播地址的特例）。
如果网卡收到一个帧，这个帧将被传送给设备驱动程序（如果帧检验和错，网卡将丢弃
该帧）。设备驱动程序将进行另外的帧过滤。首先，帧类型中必须指定要使用的协议（IP、
ARP等等）。其次，进行多播过滤来检测该主机是否属于多播地址说明的多播组。
设备驱动程序随后将数据帧传送给下一层，比如，当帧类型指定为IP数据报时，就传往
IP层。IP根据IP地址中的源地址和目的地址进行更多的过滤检测。如果正常，就将数据报传送
给下一层（如TCP或UDP）。
每次UDP收到由IP传送来的数据报，就根据目的端口号，有时还有源端口号进行数据报过滤。
如果当前没有进程使用该目的端口号，就丢弃该数据报并产生一个ICMP不可达报文
（TCP根据它的端口号作相似的过滤）。如果UDP数据报存在检验和错，将被丢弃。

> 子网掩码

根据RFC950定义，子网掩码是一个32位的2进制数， 其对应网络地址的所有位都置为1，对应于主机地址的所有位都置为0。

> 指向网络的广播

指向网络的广播地址是主机号为全1的地址。A类网络广播地址为netid.255.255.255，其中netid为A类网络的网络号。
一个路由器必须转发指向网络的广播，但它也必须有一个不进行转发的选择。

> 指向子网的广播

指向子网的广播地址为主机号为全1且有特定子网号的地址。作为子网直接广播地址的IP
地址需要了解子网的掩码。例如，如果路由器收到发往128.1.2.255的数据报，当B类网络128.1的子网掩码为255.255.255.0时，
该地址就是指向子网的广播地址；但如果该子网的掩码为255.255.254.0，该地址就不是指向子网的广播地址。

> 指向所有子网的广播

指向所有子网的广播也需要了解目的网络的子网掩码，以便与指向网络的广播地址区分
开。指向所有子网的广播地址的子网号及主机号为全1。例如，如果目的子网掩码为
255.255.255.0，那么IP地址128.1.255.255是一个指向所有子网的广播地址。然而，如果网络
没有划分子网，这就是一个指向网络的广播。