# 第10章 条条大路通罗马-单表访问方法

- 慢查询
- 查询优化器
- 执行计划
- 全表扫描
- 使用索引进行查询
- const
- 针对主键或唯一二级索引的等值查询
- 针对普通二级索引的等值查询
- 针对索引列的范围查询
- 直接扫描整个索引
- ref 采用二级索引来执行查询的访问方法称为： ref
- ref_or_null  当使用二级索引而不是全表扫描的方式执行该查询时，这种类型的查询使用的访问方法就称为ref_or_null
- range
- index 采用遍历二级索引记录的执行方式称之为：index
- all 用全表扫描
- 二级索引 + 回表 基本的查询模式
- range + 区间
- 所有搜索条件都可以使用某个索引的情况
- 有的搜索条件无法使用索引的情况
- 索引合并 index merge（一次查询用到多个二级索引）
- Intersection 索引合并 （a=1 and b=1）
- 读取二级索引的操作是 顺序I/O ，而回表操作是 随机I/O 
- Rowid Ordered Retrieval，简称ROR
- 回表操作的代价
- Union合并 （a=1 or b=1）
- 主键集合
- Sort-Union合并

## Intersection 索引合并

虽然读取多个二级索引比读取一个二级索引消耗性能，但是读取二级索引的操作是 顺序I/O ，而回表操作是 随
机I/O ，所以如果只读取一个二级索引时需要回表的记录数特别多，而读取多个二级索引之后取交集的记录数非
常少，当节省的因为 回表 而造成的性能损耗比访问多个二级索引带来的性能损耗更高时，读取多个二级索引后
取交集比只读取一个二级索引的成本更低。

- 情况一：二级索引列是等值匹配的情况，对于联合索引来说，在联合索引中的每个列都必须等值匹配，不能出现只出现匹配部分列的情况
- 情况二：主键列可以是范围匹配

## Union 索引合并

- 情况一：二级索引列是等值匹配的情况，对于联合索引来说，在联合索引中的每个列都必须等值匹配，不能出现只出现匹配部分列的情况。- 
- 情况二：主键列可以是范围匹配
- 情况三：使用 Intersection 索引合并的搜索条件

Sort-Union的适用场景是单独根据搜索条件从某个二级索引中获取的记录数比较少，这样即使对这些二
级索引记录按照主键值进行排序的成本也不会太高 而Intersection索引合并的适用场景是单独根据搜索条件从某个二级索引中获取的记录数太多，导致回
表开销太大，合并后可以明显降低回表开销，但是如果加入Sort-Intersection后，就需要为大量的二级索引记录按照主键值进行排序，这个成本可能比回表查询都高了，所以也就没有引入Sort-Intersection这个玩意儿。