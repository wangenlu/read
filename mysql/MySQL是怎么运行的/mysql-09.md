# 第9章 存放页面的大池子-InnoDB的表空间

- 把表空间想象成被切分为许许多多个 页 的池子
- InnoDB是以页为单位管理存储空间的
-  页面类型 Undo日志页，BLOB页，索引页（也就是我们所说的 数据页） 等等
- 区（extent）的概念
- 表空间中的页实在是太多了，为了更好的管理这些页面，设计 InnoDB 的提出了区 （英文名： extent ）的概念。
-  INSERT BUFFER
- 对于16KB的页来说，连续的64个页就是一个 区 1M
- 段（segment）的概念
- 用段来管理区
- 碎片（fragment）区
- Extent Descriptor Entry （XDES Entry）
- Change Buffer
- INODE 类型
- Insert Buffer
- Doublewrite buffer 双写缓冲区
- 元数据
- 的内部系统表（internalsystem table）
- SYS_TABLES 、 SYS_COLUMNS 、 SYS_INDEXES 、 SYS_FIELDS
- Data Dictionary Header
- information_schema系统数据库

## 区

我们每向表中插入一条记录，本质上就是向该表的聚簇索引以及所有二级索引代表的 B+ 树的节点中插入数
据。而 B+ 树的每一层中的页都会形成一个双向链表，如果是以 页 为单位来分配存储空间的话，双向链表相
邻的两个页之间的物理位置可能离得非常远。我们介绍 B+ 树索引的适用场景的时候特别提到范围查询只需
要定位到最左边的记录和最右边的记录，然后沿着双向链表一直扫描就可以了，而如果链表中相邻的两个页
物理位置离得非常远，就是所谓的 随机I/O 。再一次强调，磁盘的速度和内存的速度差了好几个数量级， 随
机I/O 是非常慢的，所以我们应该尽量让链表中相邻的页的物理位置也相邻，这样进行范围查询的时候才可
以使用所谓的 顺序I/O 。

所以，所以，所以才引入了 区 （ extent ）的概念，一个区就是在物理位置上连续的64个页。在表中数据量大
的时候，为某个索引分配空间的时候就不再按照页为单位分配了，而是按照 区 为单位分配，甚至在表中的数据
十分非常特别多的时候，可以一次性分配多个连续的区。虽然可能造成一点点空间的浪费（数据不足填充满整个
区），但是从性能角度看，可以消除很多的随机 I/O ，功大于过嘛！